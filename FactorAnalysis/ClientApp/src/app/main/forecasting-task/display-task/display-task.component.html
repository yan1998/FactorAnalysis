<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a [routerLink]="['/home']">На главную</a></li>
        <li class="breadcrumb-item"><a [routerLink]="['/forecasting-task/list']">Задачи прогнозирования</a></li>
        <li class="breadcrumb-item active" aria-current="page">{{ task.name }}</li>
    </ol>
</nav>

<div class="container">
    <div class="row">
        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xs-12">
            <h2>{{name}}</h2>
        </div>
    </div>

    <button mat-stroked-button [disabled]="isCsvDownloading" (click)="exportCsv()">
        <span>Эскпортировать в CSV</span>
        <mat-spinner class="btnSpinners" [diameter]="20" *ngIf="isCsvDownloading"></mat-spinner> 
    </button>

    <button id="uploadXmlBtn" mat-stroked-button [disabled]="isCsvUploading" (click)="csvFileInput.click()">
        <span>Upload CSV</span>
        <mat-spinner class="btnSpinners" [diameter]="20" *ngIf="isCsvUploading"></mat-spinner>
    </button>
    <input id="csvFile" [style.display]="'none'" name="csvFile" type="file" accept=".csv" #csvFileInput
        (change)="uploadCsvFile(csvFileInput.files)">

    <button mat-stroked-button [disabled]="isDataAdding" (click)="addForecastingTaskData()">
        <span>Добавить данные</span>
        <mat-spinner class="btnSpinners" [diameter]="20" *ngIf="isDataAdding"></mat-spinner> 
    </button>

    <button  mat-stroked-button [disabled]="isModelCreating"(click)="createPredictionModel()">
        <span>Обучить модель</span>
        <mat-spinner class="btnSpinners" [diameter]="20" *ngIf="isModelCreating"></mat-spinner> 
    </button>

    <button  mat-stroked-button [disabled]="isValuePredicating" (click)="predictValue()">
        <span>Спрогнозировать значение</span>
        <mat-spinner class="btnSpinners" [diameter]="20" *ngIf="isValuePredicating"></mat-spinner>
    </button>

    <div class="tableContainer mat-elevation-z8">
        <div class="loadingShade" *ngIf="isLoadingResults">
            <mat-spinner></mat-spinner>
        </div>
        <div>
            <table mat-table [dataSource]="data">
                <ng-container *ngFor="let column of task.fieldsDeclaration" matColumnDef="{{column.name}}">
                    <th mat-header-cell class="tableHeader" matTooltip="{{column.description}}" *matHeaderCellDef>{{column.name}}</th>
                    <td mat-cell *matCellDef="let row">{{row[column.name]}}</td>
                </ng-container>

                <ng-container matColumnDef="delete">
                    <th mat-header-cell *matHeaderCellDef></th>
                    <td mat-cell *matCellDef="let row">
                        <button mat-button color="warn" matTooltip="Удалить строку" matTooltipClass="tooltipRed" (click)="removeRecord(row.id)">
                            <mat-icon class="matIconActions">delete_forever</mat-icon>
                        </button>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
            <mat-paginator [length]="resultsLength" [pageSizeOptions]="[10, 50, 100, 200, 500]"></mat-paginator>
        </div>
    </div>
</div>